# Censys UDPXY 提取器 - 双模式使用指南

## 🎯 功能概述

这个增强版插件支持两种不同的工作模式：

### 1. 🔍 搜索页面模式 - IP列表提取
- **适用页面**: https://platform.censys.io/search?q=...
- **功能**: 提取搜索结果中的所有IP地址
- **输出**: 纯文本IP列表 (.txt文件)
- **用途**: 为后续的主机详情查询准备IP列表

### 2. 🖥️ 主机详情模式 - 数据收集
- **适用页面**: https://platform.censys.io/hosts/x.x.x.x
- **功能**: 提取主机的详细信息
- **输出**: CSV格式数据文件
- **字段**: ip, port, url, dns, country, city, province, isp (与censys.py保持一致)

## 🚀 使用流程

### 第一步：搜索并提取IP列表

1. 访问 [Censys Search](https://platform.censys.io/search)
2. 输入搜索查询，例如：
   ```
   (host.services.software.product = "udpxy" or web.software.product = "udpxy") and host.location.country = "China"
   ```
3. 点击插件图标，界面显示 "🔍 搜索页面模式"
4. 点击 "连接到页面" 建立连接
5. 点击 "📋 提取IP列表" 开始提取
6. 点击 "💾 下载IP.txt" 保存IP列表

### 第二步：收集主机详情数据

1. 点击搜索结果中的任一主机链接，进入详情页面
   ```
   https://platform.censys.io/hosts/221.233.156.10?at_time=...
   ```
2. 插件界面自动切换到 "🖥️ 主机详情模式"
3. 点击 "连接到页面" 建立连接
4. 点击 "➕ 收集当前主机" 收集数据（数据临时保存，不会立即下载）
5. 重复访问其他主机页面，继续收集数据
6. 当收集足够数据后，点击 "💾 导出CSV" 下载完整数据文件
7. 使用 "🗑️ 清空缓存" 可以清除所有收集的数据

## 📊 数据格式说明

### IP列表文件 (txt格式)
```
221.233.156.10
39.150.67.10
58.214.101.44
...
```

### 主机数据文件 (CSV格式)
```csv
ip,port,url,dns,country,city,province,isp
221.233.156.10,9000,http://221.233.156.10:9000,hbkygy.top,China,Wuhan,Hubei,CHINANET Hubei province network
39.150.67.10,4000,http://39.150.67.10:4000,2.ouc.cc,China,Zhengzhou,Henan,China Mobile Communications Corporation
```

## 🔧 使用技巧

### 批量收集策略
1. 先在搜索页面提取所有IP
2. 从IP列表中选择感兴趣的主机
3. 逐个访问主机详情页面收集数据
4. 插件会自动去重，相同IP的数据会被更新而不是重复添加

### 数据完整性
- 插件会尝试多种方法提取数据（JSON解析、页面文本等）
- 如果某些字段为空，可能是页面数据不完整
- 建议重新加载页面后再次收集

### 临时存储
- 收集的数据会临时保存在浏览器中
- 关闭插件或浏览器不会丢失数据
- 使用"清空缓存"可以手动清除所有数据

## ⚡ 推荐工作流程

1. **搜索阶段**：使用搜索页面模式快速获取IP列表
2. **筛选阶段**：查看IP列表，选择需要详细分析的目标
3. **收集阶段**：使用主机详情模式逐个收集数据
4. **导出阶段**：将收集的数据导出为CSV进行分析
5. **清理阶段**：完成后清空缓存，准备下次使用

## 📋 注意事项

- 确保在正确的页面类型使用对应功能
- 保持网络连接稳定，避免数据提取中断
- 遵守Censys使用条款，合理控制请求频率
- 大量数据收集时建议分批进行

## 🔍 故障排除

- **连接失败**：刷新页面后重新连接
- **数据提取失败**：确保页面完全加载后再操作
- **下载失败**：检查浏览器下载权限设置

---

这个双模式设计让你可以灵活地进行IP发现和详细数据收集，满足不同阶段的需求！
