# 🎯 Censys UDPXY 提取器 - 真正自动化版本

## ✨ 新功能特点

### 🚀 真正的自动化体验
- **无需打开插件**：启用自动收集后，访问主机页面会自动收集数据
- **页面浮动按钮**：在Censys页面上直接显示操作按钮
- **后台持久化**：数据自动保存，支持批量导出
- **智能通知**：收集成功/失败会显示页面通知

### 🎨 页面UI元素

#### 主机详情页面
- **状态指示器**：显示自动收集是否启用（绿色=启用，灰色=禁用）
- **收集按钮**：手动收集当前主机数据
- **统计显示**：实时显示已收集的主机数量

#### 搜索页面
- **提取按钮**：从搜索结果中提取IP列表

## 📖 使用方法

### 1. 启用自动收集
有两种方式启用自动收集：

**方式一：通过插件界面**
1. 在Censys主机页面点击扩展图标
2. 点击"🤖 自动收集模式"按钮
3. 按钮变为"🟢 自动收集已启用"

**方式二：通过页面按钮**
1. 在Censys主机页面找到右上角的状态指示器
2. 点击状态指示器切换自动收集模式
3. 状态从"🔴 自动收集已禁用"变为"🟢 自动收集已启用"

### 2. 自动收集工作流程
启用自动收集后：
1. 访问任意Censys主机详情页面
2. 页面加载完成3秒后自动开始收集
3. 显示成功通知："✅ 自动收集 [IP] 的数据完成"
4. 数据自动保存到缓存
5. 统计数字自动更新

### 3. 手动收集
如果不想使用自动收集，可以手动操作：
1. 在主机页面点击"📊 收集数据"按钮
2. 或在插件界面点击相关按钮

### 4. 查看和导出数据

**快速导出**
- 在插件界面点击"💾 导出CSV"

**详细统计**
- 在插件界面点击"📊 查看详细统计"
- 打开详细报告页面，包含：
  - 总体统计数据
  - 完整主机列表
  - IP列表
  - 导出功能

## 🔧 数据格式

### CSV格式（与censys.py兼容）
```csv
ip,port,url,dns,country,city,province,isp
1.2.3.4,8080,http://1.2.3.4:8080,example.com,China,Beijing,Beijing,China Telecom
```

### 字段说明
- **ip**: 主机IP地址
- **port**: UDPXY服务端口
- **url**: 完整的UDPXY服务URL
- **dns**: DNS反向解析结果
- **country**: 国家
- **city**: 城市
- **province**: 省份/州
- **isp**: 互联网服务提供商

## 🎯 使用场景

### 批量收集
1. 在Censys搜索UDPXY相关服务
2. 启用自动收集模式
3. 逐个访问搜索结果中的主机页面
4. 数据自动收集到缓存
5. 最后统一导出CSV文件

### 单次收集
1. 访问特定主机页面
2. 点击页面上的"📊 收集数据"按钮
3. 立即获取并保存数据

## 💡 技术特点

### API数据获取
- 使用Censys官方API端点：`https://platform.censys.io/hosts/{ip}?_data=routes/hosts.$id`
- 自动包含当前会话的Cookie
- 三层数据提取策略：API → 页面JSON → 页面文本

### 智能检测
- 自动识别页面类型（搜索页面/主机页面）
- SPA应用URL变化监听
- 自动创建对应的UI元素

### 数据持久化
- 使用Chrome扩展存储API
- 数据在浏览器关闭后保持
- 支持增量更新（相同IP会覆盖旧数据）

## ⚠️ 注意事项

1. **登录状态**：需要在Censys网站保持登录状态
2. **权限要求**：需要有访问主机详情的权限
3. **数据限制**：受Censys账户的API调用限制
4. **刷新生效**：修改自动收集设置后，建议刷新页面确保生效
5. **数据备份**：重要数据建议及时导出备份

## 🆚 对比传统方式

| 功能 | 传统方式 | 新版本 |
|------|----------|---------|
| 操作方式 | 每个页面都要打开插件 | 访问页面自动收集 |
| 用户体验 | 繁琐重复 | 一键启用，全自动 |
| 数据获取 | 页面解析 | API + 页面解析 |
| 数据完整性 | 可能缺失字段 | 完整字段提取 |
| 批量处理 | 效率低 | 高效批量收集 |
| 状态反馈 | 插件界面 | 页面实时通知 |

## 🔄 更新记录

### v2.0.0 - 真正自动化版本
- ✅ 添加页面浮动UI元素
- ✅ 实现真正的自动收集功能
- ✅ 使用官方API端点获取完整数据
- ✅ 添加页面实时通知系统
- ✅ 优化用户体验，减少手动操作
- ✅ 添加详细统计报告功能
- ✅ 支持页面直接操作，无需打开插件

现在您可以真正实现"设置一次，自动收集"的工作流程！
