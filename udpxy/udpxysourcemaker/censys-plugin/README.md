# Censys UDPXY Extractor Browser Extension

## 🎯 功能简介

这是一个 Chrome 浏览器扩展，用于从 Censys 搜索结果中自动提取 UDPXY 服务器信息。通过在已登录的浏览器环境中运行，完全绕过 Cloudflare 和反自动化检测。

## ✨ 主要特性

- **🔍 智能提取**: 自动识别和提取 UDPXY 服务器 IP 地址
- **🤖 自动搜索**: 支持多个预设查询的自动化搜索
- **📊 多格式导出**: 支持 CSV、M3U、TXT 多种格式输出
- **🛡️ 反检测**: 在真实浏览器环境中运行，绕过所有检测机制
- **📈 实时统计**: 显示提取进度和结果统计
- **💾 批量下载**: 一键下载所有格式的结果文件

## 🚀 安装方法

### 1. 克隆或下载项目
```bash
git clone <repository_url>
cd censys-plugin
```

### 2. 在 Chrome 中加载扩展
1. 打开 Chrome 浏览器
2. 访问 `chrome://extensions/`
3. 开启右上角的"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择 `censys-plugin` 文件夹
6. 扩展安装完成

### 3. 验证安装
- 在 Chrome 扩展栏中看到 Censys UDPXY Extractor 图标
- 点击图标应显示美观的弹出界面

## 📖 使用说明

### 基本使用流程

1. **登录 Censys**
   - 访问 https://platform.censys.io
   - 正常登录你的 Censys 账户

2. **导航到搜索页面**
   - 确保当前页面 URL 包含 `platform.censys.io`
   - 可以是搜索页面或搜索结果页面

3. **启动扩展**
   - 点击浏览器工具栏中的扩展图标
   - 界面显示当前统计信息和操作按钮

4. **选择提取方式**：

   **方式一：单页提取**
   - 点击 "📊 Extract Current Page" 按钮
   - 扩展将提取当前页面的所有 UDPXY 结果

   **方式二：自动搜索**
   - 点击 "🤖 Auto Search & Extract" 按钮
   - 扩展将自动执行多个预设查询：
     - `services.http.response.body: "udpxy"`
     - `udpxy`
     - `services.service_name: "HTTP" and udpxy`
   - 每个查询最多处理 3 页结果

5. **下载结果**
   - 提取完成后，"💾 Download Results" 按钮变为可用
   - 点击下载按钮将生成三种格式文件：
     - `udpxy_results_TIMESTAMP.csv` - 详细的 CSV 数据
     - `udpxy_servers_TIMESTAMP.m3u` - IPTV 播放列表格式
     - `udpxy_ips_TIMESTAMP.txt` - 简单的 IP 列表

### 高级功能

**实时统计监控**
- IPs Found: 已发现的唯一 IP 地址数量
- Pages: 已处理的页面数量
- Time: 从开始提取到现在的用时

**智能去重**
- 自动识别并移除重复的 IP 地址
- 保留每个 IP 的最完整元数据

**多种数据源支持**
- 结构化搜索结果元素
- 页面原始文本内容
- 支持新旧版本的 Censys 界面

## 📁 输出格式说明

### CSV 格式 (udpxy_results_*.csv)
```csv
IP,Port,Country,Organization,ISP,Services,Last_Seen
"192.168.1.100","4022","China","Example Corp","Example ISP","HTTP","2024-01-01"
```

### M3U 格式 (udpxy_servers_*.m3u)
```m3u
#EXTM3U
#EXTINF:-1,UDPXY-192.168.1.100:4022
http://192.168.1.100:4022/udp/
```

### TXT 格式 (udpxy_ips_*.txt)
```
192.168.1.100:4022
192.168.1.101:4022
```

## 🔧 技术原理

### 架构设计
- **Manifest V3**: 使用最新的 Chrome 扩展规范
- **Content Script**: 注入到 Censys 页面的内容脚本
- **Popup Interface**: 美观的用户交互界面
- **Background Service**: 处理下载和数据管理

### 提取算法
1. **多选择器匹配**: 使用多种 CSS 选择器适配不同页面布局
2. **智能文本解析**: 当结构化元素不可用时回退到文本提取
3. **IP 验证**: 严格的 IP 地址格式验证
4. **元数据提取**: 自动提取国家、组织、ISP 等信息

### 反检测机制
- **真实浏览器环境**: 在用户已登录的浏览器中运行
- **人性化操作模拟**: 逐字符输入和随机延迟
- **无网络请求**: 所有操作都在浏览器内完成

## 🐛 故障排除

### 常见问题

**1. 扩展图标显示但点击无反应**
- 检查是否在 Censys 相关页面
- 刷新页面后重试
- 查看浏览器控制台是否有错误信息

**2. 提取结果为空**
- 确认当前页面确实有搜索结果
- 尝试手动搜索一个简单查询如 "udpxy"
- 检查页面是否完全加载

**3. 自动搜索失败**
- 确保搜索输入框可见且可交互
- 检查网络连接是否稳定
- 等待页面完全加载后再尝试

**4. 下载功能不工作**
- 检查浏览器下载权限设置
- 确保有提取到有效数据
- 尝试关闭并重新打开扩展

### 调试模式

如需调试，可以：
1. 打开 Chrome 开发者工具 (F12)
2. 切换到 Console 标签
3. 查看以 `[Censys Extractor]` 开头的日志信息

## 🔄 更新日志

### v1.0.0 (当前版本)
- ✅ 基础 IP 提取功能
- ✅ 多格式导出支持
- ✅ 自动搜索功能
- ✅ 美观的用户界面
- ✅ 实时统计显示

## 📞 技术支持

如遇到问题或需要新功能，请：
1. 检查故障排除部分
2. 查看浏览器控制台错误信息
3. 提供详细的错误描述和重现步骤

## 📜 许可证

本项目仅供学习和研究目的使用。使用时请遵守 Censys 的服务条款和相关法律法规。

---

**⚠️ 重要提示**: 
- 请确保你有合法的 Censys 账户和使用权限
- 合理使用搜索功能，避免过于频繁的请求
- 提取的数据仅供合法用途使用
